@model catalogo_jogos.Models.Jogo
@{
    ViewData["Title"] = @Model.Name;

    // LÊ OS FILTROS QUE A 'LISTAJOGOS' ENVIOU PELA URL
    var termoBusca = Context.Request.Query["termoBusca"];
    var sortOrder = Context.Request.Query["sortOrder"];
    var filtroAno = Context.Request.Query["filtroAno"];
    var filtroNaoZerados = Context.Request.Query["filtroNaoZerados"];
}

<style>
    .game-cover-wrapper {
        max-width: 360px;
        margin: 0 auto;
    }

    .game-cover {
        width: 100%;
        height: auto;
        aspect-ratio: 3 / 4;
        object-fit: cover;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    .screenshot {
        width: 100%;
        height: 300px;
        object-fit: cover;
        border-radius: 8px;
        margin-bottom: 15px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        cursor: pointer;
    }

    .modal-img {
        width: 100%;
        height: auto;
        border-radius: 8px;
    }

    .info-card {
        background-color: #f8f9fa;
    }
</style>

<div class="container mt-4 mb-5" style="max-width: 900px;">

    <div class="row">
        <div class="col-12 text-center">
            <h1 class="display-4 mb-4">@Model.Name</h1>
        </div>
    </div>

    <div class="row justify-content-center">
        <div class="col-lg-10">

            <div class="card mb-4">
                <div class="card-body text-center p-3">
                    <div class="game-cover-wrapper">
                        @if (!string.IsNullOrEmpty(Model.CoverUrl))
                        {
                            <img src="@Model.CoverUrl" alt="Capa de @Model.Name" class="game-cover" />
                        }
                        else
                        {
                            <div class="alert alert-secondary m-0">Nenhuma capa cadastrada.</div>
                        }
                    </div>
                </div>
            </div>

            <div class="card mb-4 info-card">
                <div class="card-header text-center">
                    <h4>Informações</h4>
                </div>
                <ul class="list-group list-group-flush">
                    <li class="list-group-item d-flex justify-content-between align-items-center info-card">
                        Ano Jogado/Terminado
                        <span class="fw-bold">@Model.Year</span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center info-card">
                        Nota
                        <span class="badge bg-primary rounded-pill fs-6">@Model.Grade</span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center info-card">
                        Terminado esse ano?
                        @if (Model.FinishedInThisYear)
                        {
                            <span class="fw-bold">Sim</span>
                        }
                        else
                        {
                            <span class="fw-bold">Não</span>
                        }
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center info-card">
                        Ordem na Lista
                        <span class="fw-bold">@Model.Ordem</span>
                    </li>
                </ul>
            </div>

            <div class="card">
                <div class="card-header text-center">
                    <h4>Screenshots</h4>
                </div>
                <div class="card-body">
                    @if (!string.IsNullOrEmpty(Model.ScreenshotUrl1) || !string.IsNullOrEmpty(Model.ScreenshotUrl2))
                    {
                        <div class="row">
                            @if (!string.IsNullOrEmpty(Model.ScreenshotUrl1))
                            {
                                <div class="col-md-6">
                                    <a href="#" data-bs-toggle="modal" data-bs-target="#imageModal"
                                       onclick="showImageInModal('@Model.ScreenshotUrl1')">
                                        <img src="@Model.ScreenshotUrl1" alt="Screenshot 1" class="screenshot" />
                                    </a>
                                </div>
                            }
                            @if (!string.IsNullOrEmpty(Model.ScreenshotUrl2))
                            {
                                <div class="col-md-6">
                                    <a href="#" data-bs-toggle="modal" data-bs-target="#imageModal"
                                       onclick="showImageInModal('@Model.ScreenshotUrl2')">
                                        <img src="@Model.ScreenshotUrl2" alt="Screenshot 2" class="screenshot" />
                                    </a>
                                </div>
                            }
                        </div>
                    }
                    else
                    {
                        <div class="alert alert-secondary m-0">Nenhuma screenshot cadastrada.</div>
                    }
                </div>
            </div>

        </div>
    </div>

    <div class="row mt-4">
        <div class="col-12 text-center">

            <a asp-action="TelaEdicao" asp-route-id="@Model.Id"
               asp-route-termoBusca="@termoBusca"
               asp-route-sortOrder="@sortOrder"
               asp-route-filtroAno="@filtroAno"
               asp-route-filtroNaoZerados="@filtroNaoZerados"
               class="btn btn-warning btn-lg px-5 me-2">
                Editar
            </a>

            <a asp-action="ListaJogos"
               asp-route-termoBusca="@termoBusca"
               asp-route-sortOrder="@sortOrder"
               asp-route-filtroAno="@filtroAno"
               asp-route-filtroNaoZerados="@filtroNaoZerados"
               class="btn btn-secondary btn-lg px-5">
                Voltar para a Lista
            </a>
        </div>
    </div>

</div>


<div class="modal fade" id="imageModal" tabindex="-1" aria-labelledby="imageModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-body p-2">
                <img id="modalImage" src="" alt="Screenshot Ampliada" class="modal-img" />
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
            </div>
        </div>
    </div>
</div>


@section Scripts {
    <script>
        function showImageInModal(imageUrl) {
            var modalImg = document.getElementById('modalImage');
            modalImg.src = imageUrl;
        }
    </script>
}